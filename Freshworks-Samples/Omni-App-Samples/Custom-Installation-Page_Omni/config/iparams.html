<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script
    src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script
    src="https://static.freshdev.io/fdk/2.0/assets/fresh_client.js"></script>
  <link rel="stylesheet" type="text/css"
    href="https://static.freshdev.io/fdk/2.0/assets/freshworks.css">

  <link rel="stylesheet" href="./assets/styles.css">

</head>

<body>
  <header class="product-specific title">Omni - Custom Installation Page: <span>
      Freshsales</span> üåç</header>
  <section>
    <fieldset>
      <legend>Usual HTML Form Elements</legend>
      <div class="usual-html">

        <label for="date-picker">Field 1 - Date Picker:
          <input type="date" id="date-picker">
        </label>
        <label for="field2">Field 2 - Text type input:<input type="text"
            id="field2"></label>
        <label for="dropdown"> Example dropdown field
          <select id="dropdown">
            <option value="">Please Select an option</option>
            <option value="opt1">Option 1</option>
            <option value="opt2">Option 2</option>
            <option value="opt3">Option3</option>
          </select>
        </label>
      </div>
    </fieldset>
    <br />
    <fieldset>
      <legend class="product-specific subtitle">Freshsales Specific Elements
        Implementation</legend>
      <label for="domain" class="product-specific domain">Field 1 - Domain
        <input type="text" placeholder="Domain will be data binded"
          data-bind="product.domain" id="domain" name="domain">
      </label>
      <label for="api_key" class="product-specific apiKey">Field 2 - API Key
        <input type="text" placeholder="API key will be data binded"
          data-bind="product.api_key" id="api_key" name="api_key"></label>
    </fieldset>
  </body>
<script type="text/javascript" content-type="text/javascript" async>

  /*
    Capturing all the HTML elements into javascript variables. This is cleanly populate or capture values within these HTML fields.
  */
  let customPageFields = {
    field1_datepickerHTML: document.getElementById('date-picker'),
    field2_textinputHTML: document.getElementById('field2'),
    dropdownHTML: document.getElementById('dropdown'),
    domainHTML: document.getElementById('domain'),
    api_keyHTML: document.getElementById('api_key')
  };


  /*
    Leaving the code inside getConfigs() function commented.

    Local Testing using CLI:
    1. As soon as http://localhost:10001/custom_configs page is loaded. The fields will be populated as 'undefined' for first time.
    2. Once, paramenters are installed by app user clicking 'install' button, all the fields will populate the stored values. See: .fdk/localstore to find if your values are stored successfully.
  */
  function getConfigs(configs) {
    customPageFields.field1_datepickerHTML.value = configs["field1"];
    customPageFields.field2_textinputHTML.value = configs["field2"];
    customPageFields.dropdownHTML.value = configs["field3_dropdown"];
    customPageFields.domainHTML.value = configs["field_domain"]
    customPageFields.api_keyHTML.value = configs["field_api_key"];
  }

  function postConfigs() {
    let field1 = customPageFields.field1_datepickerHTML.value;
    let field2 = customPageFields.field2_textinputHTML.value;
    let field3_dropdown = customPageFields.dropdownHTML.value;
    let field_domain = customPageFields.domainHTML.value;
    let field_api_key = customPageFields.api_keyHTML.value;
    return {
      __meta: {
        secure: ["field_api_key"]
      }, field1, field2, field3_dropdown, field_domain
    };
  }

  function validate() {
    let isValid = true;
    let input = customPageFields.field1_datepickerHTML.value;
    if (input == '') {
      isValid = false;
    }
    return isValid;
  }
</script>
<script defer src="./assets/iparams.js"></script>

</html>
